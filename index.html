<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Fox Home - 清疚</title><meta name="author" content="Foolish Fox"><meta name="copyright" content="Foolish Fox"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="FF的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="Fox Home">
<meta property="og:url" content="https://foolishfox.cn/index.html">
<meta property="og:site_name" content="Fox Home">
<meta property="og:description" content="FF的博客">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://asset.foolishfox.cn/static/avatar.jpg">
<meta property="article:author" content="Foolish Fox">
<meta property="article:tag" content="foolishfox, blog, share">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://asset.foolishfox.cn/static/avatar.jpg"><link rel="shortcut icon" href="https://asset.foolishfox.cn/static/fox_big.jpg"><link rel="canonical" href="https://foolishfox.cn/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":30,"position":"top","messagePrev":"本文上次更新于","messageNext":"天前，其中某些信息可能已经过时。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":250},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":250,"languages":{"author":"作者: Foolish Fox","link":"链接: ","source":"来源: Fox Home","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Fox Home',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-08-24 16:21:18'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><script type="text/javascript" src="/cw_init.js"></script><script type="text/javascript" src="/sw_init.js"></script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/alifont.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhheo/Post-Abstract-AI@latest/tianli_gpt.css"><meta name="generator" content="Hexo 7.0.0-rc2"><link rel="alternate" href="/atom.xml" title="Fox Home" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/static/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">43</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw iconfont icon-archive"></i><span> 归档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-categories"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/s/about"><i class="fa-fw fa-solid fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-solid fa-address-book"></i><span> 友人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/s/link"><i class="fa-fw fa-solid fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/s/link/moments"><i class="fa-fw fa fa-puzzle-piece"></i><span> 友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/s/lab/statistics"><i class="fa-fw fa-solid fa-chart-line"></i><span> 统计</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://work.foolishfox.cn"><i class="fa-fw fas fa-running"></i><span> 运动</span></a></div><div class="menus_item"><a class="site-page" href="/s/lab"><i class="fa-fw fa-solid fa-flask"></i><span> 实验室</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://asset.foolishfox.cn/static/background.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Fox Home"><span class="site-name">Fox Home</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw iconfont icon-archive"></i><span> 归档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-categories"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/s/about"><i class="fa-fw fa-solid fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-solid fa-address-book"></i><span> 友人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/s/link"><i class="fa-fw fa-solid fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/s/link/moments"><i class="fa-fw fa fa-puzzle-piece"></i><span> 友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/s/lab/statistics"><i class="fa-fw fa-solid fa-chart-line"></i><span> 统计</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://work.foolishfox.cn"><i class="fa-fw fas fa-running"></i><span> 运动</span></a></div><div class="menus_item"><a class="site-page" href="/s/lab"><i class="fa-fw fa-solid fa-flask"></i><span> 实验室</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Fox Home</h1><div id="site_social_icons"><a class="social-icon" href="https://github.com/YiHui-Liu" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:fox@foolishfox.cn" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="iconfont icon-rss" style="color: #EE7F2F;"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/posts/202012-b.html" title="本站指引"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2023/07/22/64bb4f557daf7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="本站指引"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202012-b.html" title="本站指引"><i class="fas fa-thumbtack sticky"></i>本站指引</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-21T09:03:53.000Z" title="发表于 2020-12-21 17:03:53">2020-12-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9A%8F%E8%AE%B0/">随记</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202012-b.html#post-comment"><span class="waline-comment-count" data-path="/posts/202012-b.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">如果您来自搜索引擎，可以再次使用右上角搜索内容

订阅我¶
你可以通过RSS来订阅本站的内容
推荐页面¶

关于我的介绍，戳这里
我的锻炼记录，戳这里
博客访问记录，戳这里

更多页面请查看实验室

</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/202408-journalviewer.html" title="使用油猴脚本优化期刊阅读体验"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2024/08/16/66bedd73836f7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用油猴脚本优化期刊阅读体验"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202408-journalviewer.html" title="使用油猴脚本优化期刊阅读体验">使用油猴脚本优化期刊阅读体验</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-08-16T04:51:03.000Z" title="发表于 2024-08-16 12:51:03">2024-08-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/">软件/程序</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/%E5%B7%A5%E5%85%B7/">工具</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202408-journalviewer.html#post-comment"><span class="waline-comment-count" data-path="/posts/202408-journalviewer.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">安装浏览器油猴（TemperMonkey）拓展请参考：

全网最完整Tampermonkey油猴脚本管理器安装教程
Tampermonkey油猴插件——安装与使用教程


使用油猴脚本请谨慎辨别安全性，使用前仔细阅读脚本的说明文档。
完整代码可以通过 Greasy Fork获得：Journal Viewer

在 PC 网页端在线阅读一些期刊时，往往会有一些侧边栏占据了很大的空间，极其影响阅读体验。但是通过查看网页元素，可以发现这些侧边栏存在很明显的特征，我们可以通过 JavaScript 代码来获取这些元素并删除，同时调整正文的样式，获取更好的阅读体验。
图1 APS 原始界面
图2 Science Direct 原始界面
图3 Nature 原始界面
对于 APS 旗下的期刊，可以使用以下代码：
1234let aps_sidebar = document.getElementById(&quot;article-sidebar&quot;);aps_sidebar.remove();let aps_content = document.getElementById(&quot;a ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/202407-nameresearch.html" title="使君与府君，到底该怎么喊？"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2024/07/04/6686562dc7e09.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使君与府君，到底该怎么喊？"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202407-nameresearch.html" title="使君与府君，到底该怎么喊？">使君与府君，到底该怎么喊？</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-04T07:51:10.000Z" title="发表于 2024-07-04 15:51:10">2024-07-04</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9A%8F%E8%AE%B0/">随记</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%9A%8F%E8%AE%B0/%E5%8E%86%E5%8F%B2/">历史</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202407-nameresearch.html#post-comment"><span class="waline-comment-count" data-path="/posts/202407-nameresearch.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">前言¶
三国演义中有一段经典剧情青梅煮酒论英雄，说献帝的舅舅董承与刘备暗中结盟欲除去曹操，刘备怕曹操生疑，因此每日浇水种豆。曹操听说后请刘备饮酒，议论天下英雄：

  随至小亭，已设樽俎：盘置青梅，一樽煮酒。二人对坐，开怀畅饮。酒至半酣，忽阴云漠漠，骤雨将至。从人遥指天外龙挂，操与玄德凭栏观之。操曰：“使君知龙之变化否？”玄德曰：“未知其详。”操曰：“龙能大能小，能升能隐；大则兴云吐雾，小则隐介藏形；升则飞腾于宇宙之间，隐则潜伏于波涛之内。方今春深，龙乘时变化，犹人得志而纵横四海。龙之为物，可比世之英雄。玄德久历四方，必知当世英雄。请试指言之。”玄德曰：“备肉眼安识英雄？”操曰：“休得过谦。”玄德曰：“备叨恩庇，得仕于朝。天下英雄，实有未知。”操曰：“既不识其面，亦闻其名。”玄德曰：“淮南袁术，兵粮足备，可为英雄？”操笑曰：“冢中枯骨，吾早晚必擒之！”玄德曰：“河北袁绍，四世三公，门多故吏；今虎踞冀州之地，部下能事者极多，可为英雄？“操笑曰：“袁绍色厉胆薄，好谋无断；干大事而惜身，见小利而忘命：非英雄也。玄德曰：“有一人名称七俊，威镇九州：刘景升可为英雄？”操曰：“刘表虚名无实，非英雄 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/202402-typst-block.html" title="Hexo 配置 Typst 代码高亮"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2024/01/04/659638f006b95.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo 配置 Typst 代码高亮"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202402-typst-block.html" title="Hexo 配置 Typst 代码高亮">Hexo 配置 Typst 代码高亮</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-02-12T07:36:52.000Z" title="发表于 2024-02-12 15:36:52">2024-02-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/">软件/程序</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202402-typst-block.html#post-comment"><span class="waline-comment-count" data-path="/posts/202402-typst-block.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">Hexo 处理的代码块会被包裹在 figure table tbody tr &gt; td.code pre 中，每一行代码又被 span 包裹，如果需要加入对 Typst 的支持，需要将所有的代码重新提取出来，处理后之后再填入，有两种方法可以选择：

前端修改：在 html 页面中读取代码块元素，提取代码处理后再填入(1)
标签插件（推荐）：在 hexo 生成的过程中使用标签插件 (2) 处理

前端修改¶
此方法可能需要刷新才能正常显示
此方法会将所有的 plaintext 识别为 typst，可以通过在第一行加一行说明语言来处理

引入js文件¶
12345&lt;script crossorigin=&quot;anonymous&quot; src=&quot;https://foolishfox.cn/js/hl.js&quot;&gt;&lt;/script&gt;&lt;script  id=&quot;script-main&quot;  src=&quot;https://cdn.jsdelivr.net/npm/@myriaddreamin/highlighte ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/202402-WeChatMsgAnalysis.html" title="微信聊天记录分析：去年和你的猪聊了什么？"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2024/02/01/65bb17047a719.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="微信聊天记录分析：去年和你的猪聊了什么？"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202402-WeChatMsgAnalysis.html" title="微信聊天记录分析：去年和你的猪聊了什么？">微信聊天记录分析：去年和你的猪聊了什么？</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-02-01T02:58:56.000Z" title="发表于 2024-02-01 10:58:56">2024-02-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/">软件/程序</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202402-WeChatMsgAnalysis.html#post-comment"><span class="waline-comment-count" data-path="/posts/202402-WeChatMsgAnalysis.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">评论不填写邮箱，将收不到回复通知

多图预警

ipynb文件最好从上往下依次运行，不要回过头来重新搞，获取方式：

在 Google Colab 使用在线环境运行（推荐）
下载 ipynb文件 直接运行
下载 运行所需文件


准备¶
导出聊天记录¶
依照 WeChatMsg 的教程导出 csv 文件，只需要导出文本即可。
图1 导出聊天记录
安装所需包¶
推荐在虚拟环境中安装。
1pip install numpy seaborn pandas wordcloud tqdm paddlepaddle paddlenlp
引入包¶

pandas: 基础数据框架
matplotlib &amp; seaborn: 绘图
jieba: 中文分词
wordcloud: 词云
paddlenlp: 情感分析

12345678910111213141516import reimport timeimport numpy as npimport pandas as pdimport jiebaimport jieba.posseg as psegfrom PIL import Imagefr ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/202401-typst.html" title="排版工具 Typst 教程与 Snippets"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2024/01/04/659638f006b95.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="排版工具 Typst 教程与 Snippets"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202401-typst.html" title="排版工具 Typst 教程与 Snippets">排版工具 Typst 教程与 Snippets</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-01-04T04:36:34.000Z" title="发表于 2024-01-04 12:36:34">2024-01-04</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/">软件/程序</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202401-typst.html#post-comment"><span class="waline-comment-count" data-path="/posts/202401-typst.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">个人的自用模板代码可以查看 Typst-Snippets

Typst 是 2019 年才出现的使用 Rust 编写的基于标记的排版语言，定位在 Markdown、Word 等初级工具和 LaTeX\LaTeXLATE​X 一类的高级工具之间，官方宣称其功能可以和 LaTeX\LaTeXLATE​X 一样强大，但是和 Markdown 一样简单、易用，主要应用于数学、物理和工程方面（特别是包含大量公式、图表）的论文、文章、作业、书籍和报告的编写。
基础教程¶
MacOS 和 Arch Linux 用户可以使用包管理器进行安装：
12345# macOS or Linux using Homebrewbrew install typst# Arch Linuxpacman -S typst
具体支持的发行版本可以查看 参考资料 (5)。Ubuntu 目前还只能下载编译好的二进制文件，或者安装 Rust 后从源码编译进行安装。除此之外，还需要安装编辑器的插件实现代码提示、预览等功能，VS Code 上的主要插件有：

Typst LSP
Typst Preview

除此之外，还有 Typ ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/202310-bayesian-block.html" title="学习笔记 | 贝叶斯块算法"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/static/fox_paint.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="学习笔记 | 贝叶斯块算法"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202310-bayesian-block.html" title="学习笔记 | 贝叶斯块算法">学习笔记 | 贝叶斯块算法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-10-23T07:44:34.000Z" title="发表于 2023-10-23 15:44:34">2023-10-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202310-bayesian-block.html#post-comment"><span class="waline-comment-count" data-path="/posts/202310-bayesian-block.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">

施工中

获取探测器的计数随时间或其他物理量的变化可以帮助了解发生的物理过程的各种性质。例如在 X 射线和 γ 射线天文学中十分关注光子计数随时间的变化，这一类变化被称为光变曲线，可以借此计算相应物理过程的空间尺度等性质。
基础知识¶
核辐射测量的统计性质¶
探测 X/γ 射线需要使用核辐射探测器，每探测到一个事例，探测器将会记录相应事例的物理信息，如时间、能量、径迹等。核辐射的测量充满了随机性，但是可以用统计分布来描述其中的随机性。单个放射性粒子的衰变过程是一个伯努利事件，其衰变常数为 λ\lambdaλ，则在时间 0∼t0\sim t0∼t 内发生衰变的可能性为：
\begin{align}
p = 1 - e^{-\lambda t}
\end{align}

对于由 n0n_0n0​ 个放射性粒子组成的体系，彼此之间发生衰变是独立的，则体系的衰变过程是一个 n0n_0n0​ 重伯努利过程，即 ttt 时刻发生了衰变的粒子数目 nnn 满足二项分布：
\begin{equation}\begin{split}
P(n|n_0) &amp;= C_{n_0}^np^n(1-p) ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/202310-wine-srim.html" title="使用 wine 安装 SRIM"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2023/10/11/6526b97eb92e1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用 wine 安装 SRIM"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202310-wine-srim.html" title="使用 wine 安装 SRIM">使用 wine 安装 SRIM</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-10-11T14:11:09.000Z" title="发表于 2023-10-11 22:11:09">2023-10-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/">软件/程序</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202310-wine-srim.html#post-comment"><span class="waline-comment-count" data-path="/posts/202310-wine-srim.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">前言¶
SRIM 是一个 Windows 平台上用于计算带电粒子能损的软件包，典型的应用包括计算入射离子在靶材中的射程和 dE/dxdE/dxdE/dx 能损曲线等。由于这是一个单字节程序，因此在中文系统中会存在显示问题，可以通过更改系统的区域和语言为美国/英语重启之后解决[2]，但是会很麻烦，而且可能导致其他软件出现问题（例如部分软件可能读取到错误的区域），如下图所示。
错误显示的 SRIM
为了解决这个问题，我们可以选择在 WSL 上安装 wine，通过 wine 来调用 SRIM。请注意，此处需要 WSL 更新到最新版本以支持 WSLG。
本机环境
WSL: 1.2.5.0
WSLg: 1.0.51
Ubuntu: 20.04.6
wine: 8.0.2

wine¶
wine 目前最新稳定版本更新至 8.0.2，但是 ubuntu 自带的软件源中仍为 5.0 版本。可以根据需要自行选择安装版本。
wine 5.0¶

更新与安装 wine。

1sudo apt update &amp;&amp; sudo apt install wine -y

检查 wine32 是否安装 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/202309-root-jupyter.html" title="CERN ROOT 的 Jupyter 环境"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2023/09/20/650a543c90805.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CERN ROOT 的 Jupyter 环境"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202309-root-jupyter.html" title="CERN ROOT 的 Jupyter 环境">CERN ROOT 的 Jupyter 环境</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-09-20T01:48:56.000Z" title="发表于 2023-09-20 09:48:56">2023-09-20</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/">软件/程序</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/Jupyter/">Jupyter</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/ROOT/">ROOT</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202309-root-jupyter.html#post-comment"><span class="waline-comment-count" data-path="/posts/202309-root-jupyter.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">前言¶
ROOT 是由 CERN 开发的用于实验大数据处理的框架，主要应用于核物理和高能物理领域。ROOT 主要由 C++ 编写，但较新版本中也提供了 Python 的借口，通过引入pyroot实现。
一般而言，通常在命令行输入root后，通过TBrowser浏览文件；或者使用 C++ 编写数据处理的函数，在 ROOT 中进行调用。而使用 Jupyter 来编写 ROOT 程序在学习和开发阶段较为便利。由于预编译版本的 ROOT 已经绑定了特定 Python 版本，有可能与本机的 Python 版本不匹配，所以通过源代码编译安装的方式能够避免绝大部分的兼容性问题。
安装¶
本机环境
Ubuntu 20.04.6
Python 3.10.11

目前 ROOT 的最新版本为 6.28，但为了兼容本机上的 Garfield Plus Plus，因此选择 6.26 版本。在 ROOT Releases 页面下载对应版本的安装包。
依赖¶
在 ROOT Install Dependencies 查看对应系统版本要求的依赖，对于 Ubuntu 使用一行命令解决必备依赖：
12sudo apt-g ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/202209-umami.html" title="博客成长日志 | 自建 Umami 统计"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2023/07/22/64bb4ee014c8e.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="博客成长日志 | 自建 Umami 统计"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/202209-umami.html" title="博客成长日志 | 自建 Umami 统计">博客成长日志 | 自建 Umami 统计</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-09-28T08:46:25.000Z" title="发表于 2022-09-28 16:46:25">2022-09-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/">软件/程序</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%BD%AF%E4%BB%B6-%E7%A8%8B%E5%BA%8F/%E5%8D%9A%E5%AE%A2%E6%88%90%E9%95%BF%E6%97%A5%E5%BF%97/">博客成长日志</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/202209-umami.html#post-comment"><span class="waline-comment-count" data-path="/posts/202209-umami.html"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">在一年多之前，我写了一篇博客（博客成长日志 | 准实时访问统计）介绍如何使用百度统计的API实现准实时的访问统计与展示。然而今年百度统计宣布个人版只允许保存一年的数据，而且很多功能会被关闭（例如OS统计等），再加上其API使用也不方便，因此我开始谋求其他的站点统计系统。
与百度统计同类型的竞品还有谷歌统计、51La、CNZZ等，但是这些网站与百度统计也或多或少存在类似类似的问题，同时作为个人小站，也不需要收集过于精细的用户信息（如年龄、详细地区等），所以我开始寻找自建的统计工具。

目前常用的一些开源统计工具可以查看：5 款免费开源的网站流量分析统计工具，在这其中Umami和Plausible是我认为不错的选择，再结合枋柚梓的自建个人网站数据统计分析系统，最终决定采用Umami。
Umami也存在问题：

只记录了 country，无法精确到省份
地图存在问题，如果使用要避免直接展示地图


介绍¶
Umami is an open source, privacy-focused alternative to Google Analytics. Umami provides you w ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="page-number" href="/page/3/#content-inner">3</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/static/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Foolish Fox</div><div class="author-info__description">FF的博客</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">43</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/YiHui-Liu" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:fox@foolishfox.cn" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="iconfont icon-rss" style="color: #EE7F2F;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">28</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">63.7k</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-08-24T08:21:18.469Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="footer_custom_text"><footer id="footer"><div id="footer-wrap"><div class="footer_custom_text"><svg class="footer-wave-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 100" preserveAspectRatio="none"><path class="footer-wave-path" d="M851.8,100c125,0,288.3-45,348.2-64V0H0v44c3.7-1,7.3-1.9,11-2.9C80.7,22,151.7,10.8,223.5,6.3C276.7,2.9,330,4,383,9.8 c52.2,5.7,103.3,16.2,153.4,32.8C623.9,71.3,726.8,100,851.8,100z"></path></svg><div class="footer-content"><div class="footer-content-column"><div class="footer-menu"><h2 class="footer-menu-name">开始</h2><ul id="menu-get-started" class="footer-menu-list"><li class="menu-item menu-item-type-post_type menu-item-object-product"><a href="/s/about/">关于本站</a></li></ul></div></div><div class="footer-content-column"><div class="footer-menu"><h2 class="footer-menu-name">快速链接</h2><ul id="menu-company" class="footer-menu-list"><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="/archives/">时间轴</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="/categories/">分类</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="/tags/">标签</a></li></ul></div></div><div class="footer-content-column"><div class="footer-menu"><h2 class="footer-menu-name">友情链接</h2><ul id="menu-get-started" class="footer-menu-list"><li class="menu-item menu-item-type-post_type menu-item-object-product"><a href="/s/friends/">友链</a></li><li class="menu-item menu-item-type-post_type menu-item-object-product">框架&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io/zh-cn/">Hexo</a></li><li class="menu-item menu-item-type-post_type menu-item-object-product">主题&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></li></ul></div></div><div class="footer-content-column"><div class="footer-menu"><h2 class="footer-menu-name">博客圈</h2><ul id="menu-get-started" class="footer-menu-list"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/s/circle" rel="external nofollow noreferrer" target="_blank"> <img alt="" style="width:auto;height:32px;" title="朋友圈" class="entered exited" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/2023/07/22/64bb6cfb6c8e2.png"></a></li><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.foreverblog.cn/go.html" rel="external nofollow noreferrer" target="_blank"> <img alt="" style="width:auto;height:32px;" title="穿梭虫洞-随机访问十年之约友链博客" class="entered exited" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.foreverblog.cn/wormhole_2_tp.gif"></a></li><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.travellings.cn/go.html" rel="external nofollow noreferrer" target="_blank"> <img alt="" style="width:auto;height:29px;margin-top:10px" title="开往-友链接力" class="entered exited" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.travellings.cn/assets/logo.gif"></a></li></ul></div></div></div><div class="footer-copyright"><div class="footer-copyright-wrapper"><p class="footer-copyright-text">©2020-2024 By YiHui Liu<br /><a target="_blank" href="https://beian.mps.gov.cn/#/query/webSearch?code=11010802033122" rel="noopener external nofollow noreferrer noopener">京公网安备11010802033122</a> | <a target="_blank" rel="noopener external nofollow noreferrer" href="https://beian.miit.gov.cn/"><span>京ICP备2020033890号-1</span></a> <br /><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><br/>由<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://asset.foolishfox.cn/static/upyun.png" class="inline"></a>提供云存储服务</p></div></div></div></div></footer></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  async function loadWaline () {
    try {
      const eleGroup = document.querySelectorAll('#recent-posts .waline-comment-count')
      const keyArray = Array.from(eleGroup).map(i => i.getAttribute('data-path'))

      const res = await fetch(`https://waline.foolishfox.cn/api/comment?type=count&url=${keyArray}`, { method: 'GET' })
      const result = await res.json()
      
      result.data.forEach((count, index) => {
        eleGroup[index].textContent = count
      })
    } catch (err) {
      console.error(err)
    }
  }

  window.pjax ? loadWaline() : window.addEventListener('load', loadWaline)
})()</script></div><script>window.addEventListener('load', () => {
  const changeContent = content => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = async () => {
    try {
      const res = await fetch('https://waline.foolishfox.cn/api/comment?type=recent&count=6', { method: 'GET' })
      const result = await res.json()
      const walineArray = result.data.map(e => {
        return {
          'content': changeContent(e.comment),
          'avatar': e.avatar,
          'nick': e.nick,
          'url': e.url + '#' + e.objectId,
          'date': e.time || e.insertedAt
        }
      })
      saveToLocal.set('waline-newest-comments', JSON.stringify(walineArray), 10/(60*24))
      generateHtml(walineArray)
    } catch (err) {
      console.error(err)
      const $dom = document.querySelector('#card-newest-comments .aside-list')
      $dom.textContent= "无法获取评论，请确认相关配置是否正确"
    }
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('waline-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script type="text/javascript" src="/js/custom.js"></script><script async src="https://umami.foolishfox.cn/Bf5ZmaKLu245LG" data-website-id="74204a9f-8aca-4adf-9f03-d509f0a07116" data-domains="foolishfox.cn,www.foolishfox.cn"></script><script>let tianliGPT_postSelector='';let tianliGPT_key='PXRbIO6hp2HL9zUKVpXO'; if(document.domain == "foolishfox.cn") tianliGPT_postSelector='\#post \#article-container'</script><script src="https://cdn.jsdelivr.net/gh/zhheo/Post-Abstract-AI@latest/tianli_gpt.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8839647715550857" crossorigin="anonymous"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>